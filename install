#!/bin/sh

# Exit immediately if a command exits with a non-zero status
set -e

function title {
    echo '################################################################################'
    echo '                         '$1
    echo '################################################################################'

}

title git

if which git ; then
    # Remove current .gitconfig
    rm ~/.gitconfig
    # Symlink
    ln -sv ~/.dotfiles/git/.gitconfig ~/.gitconfig
fi

title python

if ! which pip ; then
    yaourt -S python-pip --noconfirm
fi

title the_silver_searcher

if ! which ag ; then
    if which yaourt ; then
        yaourt -S the_silver_searcher --noconfirm
    fi
fi

title pgcli

if ! which pgcli ; then
    if which yaourt ; then
        yaourt -S pgcli --noconfirm
    fi
fi

title neovim

if ! which nvim ; then
    # Symlink
    ln -sv ~/.dotfiles/neovim/ ~/.config/nvim

    # Install Neovim
    if which yaourt ; then
        pip install neovim
        yaourt -S neovim --noconfirm
    fi

    # Install Plug - Vim plugin manager
    curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs \
        https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

    # Install plugins
    nvim -c SourceInstall
fi

title tmux

if ! which tmux ; then
    # Symlink
    ln -sv ~/.dotfiles/tmux/.tmux.conf ~/.tmux.conf

    # Install tmux
    if which yaourt ; then
        yaourt -S tmux --noconfirm
    fi
fi

title nvm

curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash

title fish

if ! which fish ; then
    # Symlink
    ln -sv ~/.dotfiles/fish/ ~/.config/fish
    # Install fish
    if which yaourt ; then
        yaourt -S fish --noconfirm
    fi

    # Install Oh My Fish
    curl -L https://get.oh-my.fish | fish
else
    # Install theme and font
    fish -c 'omf install shellder'
    fish -c 'omf theme shellder'
    fish -c 'omf install fonts'
    fish -c 'fonts install --powerline Inconsolata'
    # Install nvm plugin
    fish -c 'omf install nvm'
    # Set fish as default shell
    chsh -s $(which fish)
fi

